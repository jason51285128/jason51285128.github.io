---
layout: post
title: epoll 
categories: linux
tags: [epoll, io] 
---

# epoll

## 概述

监视多个io描述符，当IO事件就绪时，通知用户，否则阻塞当前线程

## 用法

1.  epoll_create创建epoll实例，返还epoll文件描述符

1.  epoll_ctl注册要监视的文件描述

1.  epoll_wait阻塞当前先线程，等待事件发生

## 水平触发和边缘触发

### 水平触发

1.  对于读操作

    只要缓冲内容不为空，LT模式返回读就绪。

1.  对于写操作

    只要缓冲区还不满，LT模式会返回写就绪。

### 边缘触发

1. 对于读操作

    1.  当缓冲区由不可读变为可读的时候，即缓冲区由空变为不空的时候。

    1.  当有新数据到达时，即缓冲区中的待读数据变多的时候。

    1.  当缓冲区有数据可读，且应用进程对相应的描述符进行EPOLL_CTL_MOD 修改EPOLLIN事件时。

2. 对于写操作

    1.  当缓冲区由不可写变为可写时。

    1.  当有旧数据被发送走，即缓冲区中的内容变少的时候。

    1.  当缓冲区有空间可写，且应用进程对相应的描述符进行EPOLL_CTL_MOD 修改EPOLLOUT事件时。
